<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ© - ÙØ§Ù„Ù†Ø³ÙŠØ§ Ù„Ù„Ø±Ø®Ø§Ù…</title>
    <style>
        /* Ø£Ù†Ù…Ø§Ø· ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠØ© Ø§Ø­ØªØ±Ø§ÙÙŠØ© - Ù…Ø¹ Ø¯Ø¹Ù… Ø§Ù„Ø§ØªØ¬Ø§Ù‡ÙŠÙ† */
        @page {
            size: A4;
            margin: 0.3cm !important;
        }

        :root {
            --primary-color: #1a365d;
            --secondary-color: #c19a53;
            --accent-color: #2c5282;
            --light-color: #f8f9fa;
            --dark-color: #2d3748;
        }

        body {
            font-family: 'Arial', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background: #f5f7fa;
            color: #2d3748;
            font-size: 10pt;
            line-height: 1.5;
            transition: all 0.2s;
        }

        /* Ø£Ù†Ù…Ø§Ø· Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© (LTR) */
        body[lang="en"] {
            direction: ltr;
            text-align: left;
        }
        body[lang="en"] .header,
        body[lang="en"] .document-info,
        body[lang="en"] .info-item label,
        body[lang="en"] .signature-section,
        body[lang="en"] .control-panel,
        body[lang="en"] .order-intro {
            text-align: left;
        }
        body[lang="en"] .document-number {
            margin-left: 0;
            margin-right: 6px;
        }
        body[lang="en"] .employee-add-notice {
            text-align: left;
        }
        body[lang="en"] .signature-line {
            margin-left: 0;
            margin-right: auto;
        }
        body[lang="en"] .order-intro {
            border-right: none;
            border-left: 2px solid #c19a53;
        }

        .header {
            text-align: center;
            margin-bottom: 8px;
            padding: 5px 0 3px 0;
            border-bottom: 2px solid #c19a53;
            position: relative;
        }

        .company-name {
            font-size: 20pt;
            font-weight: bold;
            color: #1a365d;
            font-family: 'Times New Roman', serif;
            margin-bottom: 1px;
        }

        .company-subtitle {
            font-size: 14pt;
            color: #2c5282;
            font-family: 'Times New Roman', serif;
            margin-bottom: 3px;
            padding-top: 1px;
            border-top: 1px solid #c19a53;
        }

        .department {
            font-size: 12pt;
            color: #c19a53;
            font-weight: bold;
            margin: 3px 0 2px 0;
            font-family: 'Times New Roman', serif;
            padding: 2px;
        }

        .document-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 6px 0;
            padding: 5px;
            background: #f8f9fa;
            border-radius: 4px;
            border: 1px solid #e2e8f0;
        }

        .document-date {
            font-size: 9pt;
            color: #2d3748;
            font-weight: bold;
            flex: 1;
            text-align: right;
        }
        body[lang="en"] .document-date {
            text-align: left;
        }

        .document-title {
            text-align: center;
            font-size: 18pt;
            color: #1a365d;
            font-weight: bold;
            margin: 6px 0;
            font-family: 'Times New Roman', serif;
            padding: 4px;
            flex: 2;
        }

        .document-number {
            font-size: 11pt;
            color: #c19a53;
            font-weight: bold;
            text-align: center;
            padding: 3px 6px;
            border: 2px solid #c19a53;
            border-radius: 3px;
            background: white;
            display: inline-block;
            flex: 1;
            margin-left: 6px;
        }
        body[lang="en"] .document-number {
            margin-left: 0;
            margin-right: 6px;
        }

        .control-panel {
            background: linear-gradient(135deg, #1a365d, #2c5282);
            color: white;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 12px;
            box-shadow: 0 3px 6px rgba(0,0,0,0.2);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .btn {
            padding: 6px 12px;
            margin: 5px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            transition: all 0.3s;
            font-size: 10pt;
            min-width: 130px;
            font-family: 'Times New Roman', serif;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 3px 6px rgba(0,0,0,0.2);
        }

        .btn-print {
            background: linear-gradient(135deg, #4a5568, #2d3748);
            color: white;
            border: 1px solid #2d3748;
        }

        .btn-reset {
            background: linear-gradient(135deg, #e53e3e, #c53030);
            color: white;
            border: 1px solid #c53030;
        }

        .btn-manage {
            background: linear-gradient(135deg, #2c5282, #1a365d);
            color: white;
            border: 1px solid #2c5282;
        }
        .btn-lang {
            background: linear-gradient(135deg, #6b46c1, #553c9a);
            color: white;
            border: 1px solid #6b46c1;
        }

        textarea, input, select {
            border: 1px solid #cbd5e0;
            border-radius: 2px;
            padding: 4px 6px;
            font-size: 9.5pt;
            transition: all 0.3s;
            background: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            width: 100%;
            box-sizing: border-box;
            height: 28px;
        }

        textarea:focus, input:focus, select:focus {
            border-color: #2c5282;
            box-shadow: 0 0 0 1px rgba(44, 82, 130, 0.2);
            outline: none;
        }

        .decision-text {
            min-height: 120px;
            height: 120px;
            font-size: 10.5pt;
            line-height: 1.6;
            padding: 6px;
            background: #f8f9fa;
            border: 1px solid #e2e8f0;
            border-radius: 3px;
            resize: vertical;
        }

        .signature-section {
            margin-top: 25px;
            padding-top: 8px;
            border-top: 2px solid #c19a53;
            background: #f8fafc;
            padding: 8px;
            border-radius: 4px;
        }

        .signature-box {
            border: 1px solid #cbd5e0;
            padding: 6px;
            height: 85px;
            border-radius: 3px;
            background: white;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            position: relative;
        }

        .signature-line {
            border-bottom: 1px solid #2d3748;
            margin-top: 8px;
            padding-bottom: 2px;
            width: 80%;
            margin-left: auto;
            margin-right: auto;
        }
        body[lang="en"] .signature-line {
            margin-left: 0;
            margin-right: auto;
        }

        .signature-box strong {
            font-size: 9.5pt;
            color: #1a365d;
            font-family: 'Times New Roman', serif;
            margin-bottom: 4px;
            display: block;
        }

        .signature-box div {
            font-size: 7.5pt;
            margin-top: 1px;
            color: #4a5568;
        }

        .signature-box i.fa-stamp {
            font-size: 16pt;
            color: #c19a53;
            margin-top: 2px;
            opacity: 0.9;
        }

        .document-content {
            background: white;
            padding: 10px;
            border-radius: 4px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            margin-bottom: 12px;
        }

        .order-intro {
            font-size: 10.5pt;
            text-align: justify;
            line-height: 1.6;
            margin: 6px 0;
            padding: 5px;
            background: #f8f9fa;
            border-radius: 3px;
            border-right: 2px solid #c19a53;
        }
        body[lang="en"] .order-intro {
            border-right: none;
            border-left: 2px solid #c19a53;
        }

        /* Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© - ÙƒÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ÙÙŠ ØµÙØ­Ø© ÙˆØ§Ø­Ø¯Ø© */
        @media print {
            @page {
                size: A4 portrait;
                margin: 0.5cm !important;
            }

            body {
                font-size: 10pt !important;
                line-height: 1.4 !important;
                background: white !important;
                color: black !important;
                margin: 0 !important;
                padding: 0 !important;
                width: 100% !important;
                max-height: 100vh !important;
                overflow: hidden !important;
                position: relative;
            }

            .no-print {
                display: none !important;
            }

            .content-container {
                margin: 0 !important;
                padding: 0 !important;
                box-shadow: none !important;
                max-width: 100% !important;
                height: auto;
                display: flex !important;
                flex-direction: column !important;
                margin-top: 125px !important;
                margin-bottom: 120px !important;
            }

            .print-header {
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                right: 0 !important;
                z-index: 9999 !important;
                display: block !important;
                height: 110px !important;
                text-align: center !important;
                background: white !important;
                padding: 5px 0 !important;
                margin: 0 !important;
                width: 100% !important;
                page-break-inside: avoid !important;
            }

            .print-header img {
                max-width: 100% !important;
                max-height: 80px !important;
                object-fit: contain !important;
            }

            .header {
                display: none !important;
            }

            .company-name {
                font-size: 18pt !important;
                color: black !important;
                margin-bottom: 2px !important;
            }

            .company-subtitle {
                font-size: 12pt !important;
                color: black !important;
                margin-bottom: 3px !important;
                border-top: 1px solid black !important;
                padding-top: 0 !important;
            }

            .department {
                font-size: 11pt !important;
                color: black !important;
                background: none !important;
                padding: 1px !important;
                margin: 3px 0 !important;
            }

            .document-info {
                background: none !important;
                border: 1px solid black !important;
                padding: 3px !important;
                margin: 3px 0 !important;
                display: flex !important;
                justify-content: space-between !important;
                align-items: center !important;
            }

            .document-title {
                font-size: 14pt !important;
                color: black !important;
                background: none !important;
                border-bottom: 1px solid black !important;
                border-radius: 0 !important;
                margin: 6px 0 !important;
                padding: 2px !important;
                flex: 2;
            }

            .document-number {
                border: 1px solid black !important;
                color: black !important;
                background: none !important;
                font-size: 10pt !important;
                padding: 3px 8px !important;
                flex: 1;
                margin-left: 4px !important;
            }

            .document-date {
                font-size: 9pt !important;
                flex: 1;
                text-align: right !important;
            }

            .document-content {
                box-shadow: none !important;
                padding: 0 !important;
                background: none !important;
                flex: 1 !important;
                display: flex !important;
                flex-direction: column !important;
                min-height: 0 !important;
                page-break-inside: avoid !important;
            }

            .order-intro {
                background: none !important;
                border: 1px solid #ccc !important;
                padding: 6px !important;
                margin: 8px 0 !important;
                font-size: 10pt !important;
                line-height: 1.5 !important;
                page-break-inside: avoid !important;
            }

            .decision-text {
                border: 1px solid #ccc !important;
                background: none !important;
                min-height: 140px !important;
                height: auto !important;
                max-height: 180px !important;
                font-size: 10pt !important;
                line-height: 1.5 !important;
                padding: 4px !important;
                margin: 4px 0 8px 0 !important;
                flex: 1;
                page-break-inside: avoid !important;
            }

            .info-row {
                margin-bottom: 6px !important;
                page-break-inside: avoid !important;
            }

            .info-item {
                min-width: 160px !important;
                margin-bottom: 4px !important;
            }

            .info-item label {
                font-size: 9pt !important;
                margin-bottom: 2px !important;
            }

            .signature-section {
                border-top: 2px solid black !important;
                background: none !important;
                padding: 6px 0 0 0 !important;
                margin-top: 10px !important;
                flex-shrink: 0;
                page-break-inside: avoid !important;
            }

            .signature-box {
                border: 1px solid black !important;
                background: none !important;
                height: 75px !important;
                padding: 4px !important;
                display: flex !important;
                flex-direction: column !important;
                justify-content: space-between !important;
            }

            .signature-line {
                margin-top: 4px !important;
                margin-bottom: 2px !important;
            }

            .signature-box strong {
                font-size: 9pt !important;
            }

            .signature-box div {
                font-size: 7pt !important;
            }

            .signature-box i.fa-stamp {
                font-size: 12pt !important;
            }

            textarea, input, select {
                border: none !important;
                background: none !important;
                padding: 0 !important;
                pointer-events: none;
                font-size: 9.5pt !important;
                height: auto !important;
                min-height: auto !important;
            }

            select {
                appearance: none !important;
            }

            .print-only {
                display: block !important;
            }

            .print-footer {
                position: fixed !important;
                bottom: 0 !important;
                left: 0 !important;
                right: 0 !important;
                z-index: 9999 !important;
                display: block !important;
                height: 110px !important;
                text-align: center !important;
                background: white !important;
                padding: 5px 0 !important;
                margin: 0 !important;
                width: 100% !important;
                page-break-inside: avoid !important;
                font-size: 8pt !important;
            }

            .print-footer img {
                max-width: 100% !important;
                max-height: 100px !important;
                object-fit: contain !important;
            }

            .control-panel, #auto-send-notification, .confirmation-modal {
                display: none !important;
            }

            .document-content > * {
                margin-bottom: 6px !important;
            }

            .document-content > *:last-child {
                margin-bottom: 0 !important;
            }

            .signature-section > div:first-child {
                display: flex !important;
                gap: 8px !important;
                justify-content: space-between !important;
            }

            .no-break[style*="margin-top: 10px"] {
                margin-top: 8px !important;
                margin-bottom: 8px !important;
                display: flex !important;
                gap: 10px !important;
                justify-content: space-between !important;
                flex-shrink: 0;
            }

            .avoid-break, .no-break {
                page-break-inside: avoid !important;
                page-break-before: avoid !important;
                page-break-after: avoid !important;
                break-inside: avoid !important;
            }

            .document-content > *:last-child {
                page-break-after: avoid !important;
            }

            * {
                color: black !important;
            }
        }

        @media (max-width: 768px) {
            .btn { min-width: 110px; padding: 4px 6px; font-size: 9pt; }
            .control-panel { padding: 8px; }

            .company-name {
                font-size: 16pt;
            }

            .company-subtitle {
                font-size: 10pt;
            }

            .department {
                font-size: 9pt;
            }

            .document-title {
                font-size: 14pt;
            }

            .confirmation-content {
                width: 95%;
                padding: 10px;
            }

            .document-info {
                flex-direction: column;
                gap: 4px;
            }

            .signature-box {
                height: 75px;
                padding: 5px;
            }
        }

        .info-row {
            display: flex;
            gap: 8px;
            margin-bottom: 6px;
            flex-wrap: wrap;
        }

        .info-item {
            flex: 1;
            min-width: 150px;
        }

        .info-item label {
            display: block;
            margin-bottom: 2px;
            font-weight: bold;
            color: #2c5282;
            font-size: 9pt;
        }

        .serial-display {
            background: rgba(255,255,255,0.1);
            padding: 4px 8px;
            border-radius: 2px;
            margin-top: 6px;
            font-size: 9pt;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .serial-display span {
            font-weight: bold;
            color: #c19a53;
            font-size: 9.5pt;
        }

        .auto-calculation-note {
            font-size: 7.5pt;
            color: #718096;
            text-align: center;
            margin-top: 4px;
            font-style: italic;
        }

        .content-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 8px;
            border-radius: 5px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.1);
            margin-bottom: 10px;
        }

        .compact-field {
            margin: 0 !important;
            padding: 2px 4px !important;
        }

        .no-break {
            page-break-inside: avoid;
        }

        #auto-send-notification {
            position: fixed;
            bottom: 15px;
            left: 15px;
            padding: 8px 12px;
            border-radius: 4px;
            z-index: 10000;
            font-size: 9.5pt;
            box-shadow: 0 3px 8px rgba(0,0,0,0.2);
            max-width: 300px;
            animation: slideIn 0.5s ease-out;
            display: flex;
            align-items: center;
            gap: 6px;
            border: 1px solid;
        }

        #auto-send-notification.success {
            background: #d4edda;
            color: #155724;
            border-color: #c3e6cb;
        }

        #auto-send-notification.error {
            background: #f8d7da;
            color: #721c24;
            border-color: #f5c6cb;
        }

        #auto-send-notification.info {
            background: #d1ecf1;
            color: #0c5460;
            border-color: #bee5eb;
        }

        #auto-send-notification.sending {
            background: #fff3cd;
            color: #856404;
            border-color: #ffeeba;
        }

        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        .confirmation-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .confirmation-content {
            background: white;
            padding: 12px;
            border-radius: 4px;
            width: 90%;
            max-width: 400px;
            text-align: center;
            max-height: 90vh;
            overflow-y: auto;
        }

        .confirmation-content h3 {
            color: #1a365d;
            margin-bottom: 8px;
            font-family: 'Times New Roman', serif;
            font-size: 11pt;
        }

        .confirmation-buttons {
            display: flex;
            justify-content: center;
            gap: 6px;
            margin-top: 12px;
        }

        .btn-confirm {
            background: linear-gradient(135deg, #38a169, #2f855a);
            color: white;
            padding: 4px 12px;
            border-radius: 2px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            font-size: 9pt;
        }

        .btn-cancel {
            background: linear-gradient(135deg, #a0aec0, #718096);
            color: white;
            padding: 4px 12px;
            border-radius: 2px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            font-size: 9pt;
        }

        .employee-input-container {
            position: relative;
            width: 100%;
        }

        .employee-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #cbd5e0;
            border-top: none;
            border-radius: 0 0 3px 3px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .employee-suggestion-item {
            padding: 6px 8px;
            cursor: pointer;
            font-size: 9.5pt;
            transition: background-color 0.2s;
            border-bottom: 1px solid #f1f5f9;
        }

        .employee-suggestion-item:last-child {
            border-bottom: none;
        }

        .employee-suggestion-item:hover,
        .employee-suggestion-item.active {
            background-color: #f7fafc;
            color: #2c5282;
        }

        .employee-suggestion-item.new-employee {
            color: #c53030;
            font-weight: bold;
            background-color: #fff5f5;
        }

        .employee-suggestion-item.new-employee:before {
            content: "+ ";
            color: #38a169;
        }

        .employee-input-container input {
            width: 100%;
        }

        .employee-add-notice {
            font-size: 7.5pt;
            color: #718096;
            margin-top: 2px;
            display: block;
            text-align: right;
            font-style: italic;
        }
        body[lang="en"] .employee-add-notice {
            text-align: left;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Ù†Ø§ÙØ°Ø© ØªØ£ÙƒÙŠØ¯ ØªØµÙÙŠØ± Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ -->
    <div class="confirmation-modal" id="resetConfirmationModal">
        <div class="confirmation-content">
            <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
        </div>
    </div>

    <!-- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… -->
    <div class="control-panel no-print">
        <div style="text-align: center; margin-bottom: 6px;">
            <h2 style="margin: 0 0 3px 0; font-family: 'Times New Roman', serif; font-size: 11pt;" id="system-title">
                <i class="fas fa-file-contract"></i> Ù†Ø¸Ø§Ù… Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©
            </h2>
            <h4 style="margin: 0; font-weight: normal; opacity: 0.9; font-family: 'Times New Roman', serif; font-size: 9.5pt;" id="company-subtitle-header">
                Ø´Ø±ÙƒØ© ÙØ§Ù„Ù†Ø³ÙŠØ§ Ù„ØªØ¬Ø§Ø±Ø© Ø§Ù„Ø±Ø®Ø§Ù… ÙˆØ§Ù„Ø­Ø¬Ø± Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ
            </h4>
        </div>

        <div style="text-align: center;">
            <button class="btn btn-print" onclick="prepareAndPrint()">
                <i class="fas fa-paper-plane"></i> <span data-i18n="print_send">Ø·Ø¨Ø§Ø¹Ø© ÙˆØ¥Ø±Ø³Ø§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠ</span>
            </button>
            <button class="btn btn-manage" onclick="openSerialManager()">
                <i class="fas fa-cog"></i> <span data-i18n="manage_serial">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ</span>
            </button>
            <button class="btn btn-reset" onclick="showResetConfirmation()">
                <i class="fas fa-redo"></i> <span data-i18n="reset_serial">ØªØµÙÙŠØ± Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ</span>
            </button>
            <button class="btn btn-lang" onclick="toggleLanguage()">
                <i class="fas fa-language"></i> <span id="lang-btn-text">English</span>
            </button>
        </div>

        <div class="serial-display">
            <div><span data-i18n="current_order_num">Ø±Ù‚Ù… Ø§Ù„Ø£Ù…Ø± Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ:</span></div>
            <div><span id="current-serial-display">ORD-000001</span></div>
        </div>

        <div class="auto-calculation-note">
            <i class="fas fa-info-circle"></i> <span data-i18n="auto_save_note">ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­</span>
        </div>
    </div>

    <!-- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø£Ù…Ø± Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ -->
    <div class="content-container no-break">
        <div class="document-info">
            <div class="document-date" id="current-date">--/--/----</div>
            <div class="document-title"><span data-i18n="admin_order">Ø£Ù…Ù€Ù€Ù€Ø± Ø§Ø¯Ø§Ø±ÙŠ</span></div>
            <div style="text-align: center; flex: 1;">
                <div style="font-size: 8pt; color: #4a5568; margin-bottom: 1px;" data-i18n="number_abbr">Ø±Ù‚Ù…</div>
                <div class="document-number" id="serial-number">ORD-000001</div>
            </div>
        </div>

        <div class="document-content">
            <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ù…Ø± Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ -->
            <div class="info-row no-break">
                <div class="info-item">
                    <label for="order-type" data-i18n="order_type">Ù†ÙˆØ¹ Ø§Ù„Ø£Ù…Ø±:</label>
                    <select id="order-type" class="print-field compact-field">
                        <option value="Ø²ÙŠØ§Ø¯Ø© Ø±Ø§ØªØ¨" data-i18n-option="salary_increase">Ø²ÙŠØ§Ø¯Ø© Ø±Ø§ØªØ¨</option>
                        <option value="ØªØ±Ù‚ÙŠØ©" data-i18n-option="promotion">ØªØ±Ù‚ÙŠØ©</option>
                        <option value="ØªØ¬Ø¯ÙŠØ¯ Ø¹Ù‚Ø¯ Ø¹Ù…Ù„" data-i18n-option="contract_renewal">ØªØ¬Ø¯ÙŠØ¯ Ø¹Ù‚Ø¯ Ø¹Ù…Ù„</option>
                        <option value="Ù†Ù‚Ù„" data-i18n-option="transfer">Ù†Ù‚Ù„</option>
                        <option value="Ø¥Ù†Ø°Ø§Ø±" data-i18n-option="warning">Ø¥Ù†Ø°Ø§Ø±</option>
                        <option value="Ø®ØµÙ…" data-i18n-option="deduction">Ø®ØµÙ…</option>
                        <option value="Ù…ÙƒØ§ÙØ£Ø©" data-i18n-option="bonus">Ù…ÙƒØ§ÙØ£Ø©</option>
                        <option value="ØªØ¹Ø¯ÙŠÙ„ Ø±Ø§ØªØ¨" data-i18n-option="salary_adjustment">ØªØ¹Ø¯ÙŠÙ„ Ø±Ø§ØªØ¨</option>
                        <option value="Ø¥Ø¬Ø§Ø²Ø©" data-i18n-option="leave">Ø¥Ø¬Ø§Ø²Ø©</option>
                        <option value="Ø¥Ù†Ù‡Ø§Ø¡ Ø®Ø¯Ù…Ø©" data-i18n-option="termination">Ø¥Ù†Ù‡Ø§Ø¡ Ø®Ø¯Ù…Ø©</option>
                        <option value="Ø£Ø®Ø±Ù‰" data-i18n-option="other">Ø£Ø®Ø±Ù‰</option>
                    </select>
                </div>

                <div class="info-item">
                    <label for="employee-input" data-i18n="employee_name">Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù:</label>
                    <div class="employee-input-container">
                        <input type="text" id="employee-input" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù Ø£Ùˆ Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©" class="print-field compact-field" data-i18n-placeholder="employee_placeholder">
                        <div class="employee-suggestions" id="employee-suggestions"></div>
                    </div>
                    <span class="employee-add-notice"></span>
                </div>

                <div class="info-item">
                    <label for="employee-id" data-i18n="id_number">Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©:</label>
                    <input type="text" id="employee-id" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© / Ø§Ù„Ø¥Ù‚Ø§Ù…Ø©" class="print-field compact-field" data-i18n-placeholder="id_placeholder">
                </div>
            </div>

            <div class="info-row no-break">
                <div class="info-item">
                    <label for="job-title" data-i18n="job_title">Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ:</label>
                    <input type="text" id="job-title" placeholder="Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ" class="print-field compact-field" data-i18n-placeholder="job_placeholder">
                </div>

                <div class="info-item">
                    <label for="department-name" data-i18n="department">Ø§Ù„Ù‚Ø³Ù…:</label>
                    <select id="department-name" class="print-field compact-field">
                        <option value="" data-i18n-option="select_dept">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù…</option>
                        <option value="Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©" data-i18n-option="accounting">Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©</option>
                        <option value="Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª" data-i18n-option="sales">Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</option>
                        <option value="Ø§Ø¯Ø§Ø±Ø© Ù…Ø³ØªÙˆØ¯Ø¹Ø§Øª" data-i18n-option="warehouse">Ø§Ø¯Ø§Ø±Ø© Ù…Ø³ØªÙˆØ¯Ø¹Ø§Øª</option>
                        <option value="Ø§Ù„Ù†Ù‚Ù„ÙŠØ§Øª" data-i18n-option="transport">Ø§Ù„Ù†Ù‚Ù„ÙŠØ§Øª</option>
                        <option value="Ø§Ù„Ø§Ù„ÙŠØ§Øª" data-i18n-option="machinery">Ø§Ù„Ø§Ù„ÙŠØ§Øª</option>
                        <option value="Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹" data-i18n-option="projects">Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</option>
                        <option value="Ø§Ù„Ø±Ø®Ø§Ù…" data-i18n-option="marble">Ø§Ù„Ø±Ø®Ø§Ù…</option>
                        <option value="Ø§Ù„ØªØµÙ…ÙŠÙ…" data-i18n-option="design">Ø§Ù„ØªØµÙ…ÙŠÙ…</option>
                        <option value="Ø§Ù„Ø³ÙˆØ´ÙŠØ§Ù„ Ù…ÙŠØ¯ÙŠØ§" data-i18n-option="social">Ø§Ù„Ø³ÙˆØ´ÙŠØ§Ù„ Ù…ÙŠØ¯ÙŠØ§</option>
                    </select>
                </div>

                <div class="info-item">
                    <label for="supervisor-name" data-i18n="direct_supervisor">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±:</label>
                    <select id="supervisor-name" class="print-field compact-field">
                        <option value="" data-i18n-option="select_supervisor">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</option>
                        <option value="Ù…Ù‡Ù†Ø¯ Ù†ÙŠØ§Ø²ÙŠ Ø§Ù„Ø³Ù„Ù‚">Ù…Ù‡Ù†Ø¯ Ù†ÙŠØ§Ø²ÙŠ Ø§Ù„Ø³Ù„Ù‚</option>
                        <option value="Ø±ÙƒØ§Ù† Ø¥ÙŠØ§Ø¯ Ø²ÙŠØ§Ø²">Ø±ÙƒØ§Ù† Ø¥ÙŠØ§Ø¯ Ø²ÙŠØ§Ø²</option>
                        <option value="Ù…Ø£Ù…ÙˆÙ† Ø§Ø­Ù…Ø¯ Ø­Ø¬Ø§Ø²ÙŠ">Ù…Ø£Ù…ÙˆÙ† Ø§Ø­Ù…Ø¯ Ø­Ø¬Ø§Ø²ÙŠ</option>
                        <option value="Ø£Ù†Ø³ Ù…Ø­Ù…Ø¯ Ø§Ù„Ø³Ø±Ø¯Ø§Ù†ÙŠ">Ø£Ù†Ø³ Ù…Ø­Ù…Ø¯ Ø§Ù„Ø³Ø±Ø¯Ø§Ù†ÙŠ</option>
                        <option value="Ø±Ù…Ø¶Ø§Ù† - Ø§Ù„ØªØµÙ…ÙŠÙ…">Ø±Ù…Ø¶Ø§Ù† - Ø§Ù„ØªØµÙ…ÙŠÙ…</option>
                        <option value="Ø£Ù…ÙŠÙ† Ø§Ø­Ù…Ø¯ Ø­Ø¬Ø§Ø²ÙŠ">Ø£Ù…ÙŠÙ† Ø§Ø­Ù…Ø¯ Ø­Ø¬Ø§Ø²ÙŠ</option>
                    </select>
                </div>
            </div>

            <!-- Ù†Øµ Ø§Ù„Ø£Ù…Ø± Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ -->
            <div class="order-intro no-break" id="decision-intro">
                Ù‚Ø±Ø±Ù†Ø§ Ù†Ø­Ù† Ø´Ø±ÙƒØ© ÙØ§Ù„Ù†Ø³ÙŠØ§ Ù„Ù„Ø±Ø®Ø§Ù… ÙˆØ§Ù„Ø­Ø¬Ø± Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ Ø§Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ù€Ù€Ù€Ù€Ù€Ù€Ø±ÙŠØ© Ø¨Ø§ØªØ®Ø§Ø° Ø§Ù„Ù‚Ø±Ø§Ø± Ø§Ù„ØªØ§Ù„ÙŠ :-
            </div>

            <div class="no-break">
                <label for="decision-details" style="display: block; margin-bottom: 4px; font-weight: bold; color: #2c5282; font-size: 9.5pt;" data-i18n="decision_details">
                    ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù‚Ø±Ø§Ø±:
                </label>
                <textarea id="decision-details" class="decision-text print-field no-break"
                          placeholder="Ø§ÙƒØªØ¨ Ù‡Ù†Ø§ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù‚Ø±Ø§Ø± Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ..." data-i18n-placeholder="decision_placeholder"></textarea>
            </div>

            <!-- ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ†ÙÙŠØ° ÙˆØ§Ù„Ù…ØµØ¯Ù‘Ø± -->
            <div class="no-break" style="margin-top: 10px; display: flex; gap: 8px;">
                <div style="flex: 1;">
                    <label for="effective-date" style="display: block; margin-bottom: 2px; font-weight: bold; color: #2c5282; font-size: 9.5pt;" data-i18n="effective_date">
                        ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ†ÙÙŠØ°:
                    </label>
                    <input type="text" id="effective-date" class="print-field compact-field" placeholder="ÙŠÙˆÙ…/Ø´Ù‡Ø±/Ø³Ù†Ø©" data-i18n-placeholder="date_placeholder">
                </div>

                <div style="flex: 1;">
                    <label for="issuer-name" style="display: block; margin-bottom: 2px; font-weight: bold; color: #2c5282; font-size: 9.5pt;" data-i18n="issuer_name">
                        Ø§Ø³Ù… Ù…ÙØµÙ’Ø¯ÙØ± Ø§Ù„Ø£Ù…Ø±:
                    </label>
                    <input type="text" id="issuer-name" class="print-field compact-field" placeholder="Ø§Ø³Ù… Ù…Ø³Ø¤ÙˆÙ„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©" data-i18n-placeholder="issuer_placeholder">
                </div>
            </div>

            <!-- Ø§Ù„ØªÙˆØ§Ù‚ÙŠØ¹ -->
            <div class="signature-section no-break">
                <div style="text-align: center; margin-bottom: 6px; font-weight: bold; font-size: 9.5pt; color: #1a365d;" data-i18n="signatures_title">
                    ØªÙˆØ§Ù‚ÙŠØ¹ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ†
                </div>

                <div style="display: flex; gap: 6px;">
                    <div style="flex: 1;">
                        <div class="signature-box">
                            <strong data-i18n="gm_signature">ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…</strong>
                            <div class="signature-line"></div>
                        </div>
                    </div>

                    <div style="flex: 1;">
                        <div class="signature-box">
                            <strong data-i18n="fm_signature">ØªÙˆÙ‚ÙŠØ¹ Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©</strong>
                            <div class="signature-line"></div>
                        </div>
                    </div>

                    <div style="flex: 1;">
                        <div class="signature-box">
                            <strong data-i18n="hod_signature">ØªÙˆÙ‚ÙŠØ¹ Ù…Ø¯ÙŠØ± Ø§Ù„Ù‚Ø³Ù…</strong>
                            <div style="margin-top: 1px; font-size: 1pt; color: #c19a53;">
                                <i class="fas fa-stamp"></i>
                            </div>
                            <div class="signature-line"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // =============================================
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨ÙˆØª ØªÙ„ÙŠØ¬Ø±Ø§Ù… Ø§Ù„Ø«Ø§Ø¨Øª
        // =============================================

        const TELEGRAM_CONFIG = {
            BOT_TOKEN: "8281101424:AAE6ehBJYqVyf3DuvhnU2Lx0jFhcDA7-O5o",
            CHANNELS: {
                HR: "-1003522590294",
            }
        };

        // =============================================
        // Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ±Ø¬Ù…Ø© (i18n)
        // =============================================
        const translations = {
            ar: {
                // Ø¹Ù†Ø§ÙˆÙŠÙ† ÙˆØ£Ø²Ø±Ø§Ø±
                'system-title': '<i class="fas fa-file-contract"></i> Ù†Ø¸Ø§Ù… Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©',
                'company-subtitle-header': 'Ø´Ø±ÙƒØ© ÙØ§Ù„Ù†Ø³ÙŠØ§ Ù„ØªØ¬Ø§Ø±Ø© Ø§Ù„Ø±Ø®Ø§Ù… ÙˆØ§Ù„Ø­Ø¬Ø± Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ',
                'print_send': 'Ø·Ø¨Ø§Ø¹Ø© ÙˆØ¥Ø±Ø³Ø§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠ',
                'manage_serial': 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ',
                'reset_serial': 'ØªØµÙÙŠØ± Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ',
                'current_order_num': 'Ø±Ù‚Ù… Ø§Ù„Ø£Ù…Ø± Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ:',
                'auto_save_note': 'ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­',
                'admin_order': 'Ø£Ù…Ù€Ù€Ù€Ø± Ø§Ø¯Ø§Ø±ÙŠ',
                'number_abbr': 'Ø±Ù‚Ù…',
                'order_type': 'Ù†ÙˆØ¹ Ø§Ù„Ø£Ù…Ø±:',
                'employee_name': 'Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù:',
                'id_number': 'Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©:',
                'job_title': 'Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ:',
                'department': 'Ø§Ù„Ù‚Ø³Ù…:',
                'direct_supervisor': 'Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±:',
                'decision_details': 'ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù‚Ø±Ø§Ø±:',
                'effective_date': 'ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ†ÙÙŠØ°:',
                'issuer_name': 'Ø§Ø³Ù… Ù…ÙØµÙ’Ø¯ÙØ± Ø§Ù„Ø£Ù…Ø±:',
                'signatures_title': 'ØªÙˆØ§Ù‚ÙŠØ¹ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ†',
                'gm_signature': 'ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…',
                'fm_signature': 'ØªÙˆÙ‚ÙŠØ¹ Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©',
                'hod_signature': 'ØªÙˆÙ‚ÙŠØ¹ Ù…Ø¯ÙŠØ± Ø§Ù„Ù‚Ø³Ù…',
                // placeholders
                'employee_placeholder': 'Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù Ø£Ùˆ Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©',
                'id_placeholder': 'Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© / Ø§Ù„Ø¥Ù‚Ø§Ù…Ø©',
                'job_placeholder': 'Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ',
                'decision_placeholder': 'Ø§ÙƒØªØ¨ Ù‡Ù†Ø§ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù‚Ø±Ø§Ø± Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ...',
                'date_placeholder': 'ÙŠÙˆÙ…/Ø´Ù‡Ø±/Ø³Ù†Ø©',
                'issuer_placeholder': 'Ø§Ø³Ù… Ù…Ø³Ø¤ÙˆÙ„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©',
                // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ù„Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£ÙˆØ§Ù…Ø±
                'option_salary_increase': 'Ø²ÙŠØ§Ø¯Ø© Ø±Ø§ØªØ¨',
                'option_promotion': 'ØªØ±Ù‚ÙŠØ©',
                'option_contract_renewal': 'ØªØ¬Ø¯ÙŠØ¯ Ø¹Ù‚Ø¯ Ø¹Ù…Ù„',
                'option_transfer': 'Ù†Ù‚Ù„',
                'option_warning': 'Ø¥Ù†Ø°Ø§Ø±',
                'option_deduction': 'Ø®ØµÙ…',
                'option_bonus': 'Ù…ÙƒØ§ÙØ£Ø©',
                'option_salary_adjustment': 'ØªØ¹Ø¯ÙŠÙ„ Ø±Ø§ØªØ¨',
                'option_leave': 'Ø¥Ø¬Ø§Ø²Ø©',
                'option_termination': 'Ø¥Ù†Ù‡Ø§Ø¡ Ø®Ø¯Ù…Ø©',
                'option_other': 'Ø£Ø®Ø±Ù‰',
                // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
                'option_select_dept': 'Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù…',
                'option_accounting': 'Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©',
                'option_sales': 'Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª',
                'option_warehouse': 'Ø§Ø¯Ø§Ø±Ø© Ù…Ø³ØªÙˆØ¯Ø¹Ø§Øª',
                'option_transport': 'Ø§Ù„Ù†Ù‚Ù„ÙŠØ§Øª',
                'option_machinery': 'Ø§Ù„Ø§Ù„ÙŠØ§Øª',
                'option_projects': 'Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹',
                'option_marble': 'Ø§Ù„Ø±Ø®Ø§Ù…',
                'option_design': 'Ø§Ù„ØªØµÙ…ÙŠÙ…',
                'option_social': 'Ø§Ù„Ø³ÙˆØ´ÙŠØ§Ù„ Ù…ÙŠØ¯ÙŠØ§',
                'option_select_supervisor': 'Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„',
                // Ù…Ù‚Ø¯Ù…Ø© Ø§Ù„Ù‚Ø±Ø§Ø±
                'decision_intro': 'Ù‚Ø±Ø±Ù†Ø§ Ù†Ø­Ù† Ø´Ø±ÙƒØ© ÙØ§Ù„Ù†Ø³ÙŠØ§ Ù„Ù„Ø±Ø®Ø§Ù… ÙˆØ§Ù„Ø­Ø¬Ø± Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ Ø§Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ù€Ù€Ù€Ù€Ù€Ù€Ø±ÙŠØ© Ø¨Ø§ØªØ®Ø§Ø° Ø§Ù„Ù‚Ø±Ø§Ø± Ø§Ù„ØªØ§Ù„ÙŠ :-',
                // Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù… (Ø¬Ø²Ø¡ Ù…Ù†Ù‡Ø§)
                'telegram_title': 'ğŸ“‹ *Ø£Ù…Ø± Ø¥Ø¯Ø§Ø±ÙŠ Ø¬Ø¯ÙŠØ¯ - Ø´Ø±ÙƒØ© ÙØ§Ù„Ù†Ø³ÙŠØ§ Ù„Ù„Ø±Ø®Ø§Ù…*',
                'telegram_order_info': 'ğŸ“… *Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ù…Ø±:*',
                'telegram_employee_info': 'ğŸ‘¤ *Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù:*',
                'telegram_decision': 'ğŸ“œ *ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù‚Ø±Ø§Ø±:*',
                'telegram_footer': 'ğŸ›ï¸ *Ø´Ø±ÙƒØ© ÙØ§Ù„Ù†Ø³ÙŠØ§ Ù„ØªØ¬Ø§Ø±Ø© Ø§Ù„Ø±Ø®Ø§Ù… ÙˆØ§Ù„Ø­Ø¬Ø± Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ*\nğŸ“ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©\nğŸ”„ *ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø± Ø¢Ù„ÙŠØ§Ù‹ Ø¹Ø¨Ø± Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ*\nğŸ“Š *Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Â©',
                // Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
                'notification_saved': 'âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙˆØ¸Ù "{name}" Ø¥Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©',
                'notification_reset': 'âœ… ØªÙ… ØªØµÙÙŠØ± Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ Ø¨Ù†Ø¬Ø§Ø­',
                'notification_enter_name': 'âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù Ø£ÙˆÙ„Ø§Ù‹',
                'notification_enter_details': 'âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù‚Ø±Ø§Ø±',
                'notification_sending': 'ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø£Ù…Ø± Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©...',
                'notification_sent': 'âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø£Ù…Ø± "{name}" Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©',
                'notification_failed': 'âŒ ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø£Ù…Ø±ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹',
                'notification_error': 'âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ',
                'notification_serial_saved': 'âœ… ØªÙ… Ø­ÙØ¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ',
                'notification_backup_restored': 'âœ… ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©',
                'notification_backup_failed': 'âŒ ÙØ´Ù„ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©',
            },
            en: {
                'system-title': '<i class="fas fa-file-contract"></i> Administrative Orders System',
                'company-subtitle-header': 'Valencia Marble & Natural Stone Trading Co.',
                'print_send': 'Print & Auto Send',
                'manage_serial': 'Manage Serial Number',
                'reset_serial': 'Reset Serial Number',
                'current_order_num': 'Current Order Number:',
                'auto_save_note': 'Data is automatically saved in browser',
                'admin_order': 'ADMINISTRATIVE ORDER',
                'number_abbr': 'No.',
                'order_type': 'Order Type:',
                'employee_name': 'Employee Name:',
                'id_number': 'ID Number:',
                'job_title': 'Job Title:',
                'department': 'Department:',
                'direct_supervisor': 'Direct Supervisor:',
                'decision_details': 'Decision Details:',
                'effective_date': 'Effective Date:',
                'issuer_name': 'Issuer Name:',
                'signatures_title': 'Officials Signatures',
                'gm_signature': 'General Manager',
                'fm_signature': 'Finance Manager',
                'hod_signature': 'Department Head',
                // placeholders
                'employee_placeholder': 'Type employee name or select from list',
                'id_placeholder': 'Nationality / Residence ID',
                'job_placeholder': 'Job title',
                'decision_placeholder': 'Write the administrative decision details here...',
                'date_placeholder': 'dd/mm/yyyy',
                'issuer_placeholder': 'HR Manager name',
                // options
                'option_salary_increase': 'Salary Increase',
                'option_promotion': 'Promotion',
                'option_contract_renewal': 'Contract Renewal',
                'option_transfer': 'Transfer',
                'option_warning': 'Warning',
                'option_deduction': 'Deduction',
                'option_bonus': 'Bonus',
                'option_salary_adjustment': 'Salary Adjustment',
                'option_leave': 'Leave',
                'option_termination': 'Termination',
                'option_other': 'Other',
                // departments
                'option_select_dept': 'Select Department',
                'option_accounting': 'Accounting',
                'option_sales': 'Sales',
                'option_warehouse': 'Warehouse Management',
                'option_transport': 'Transport',
                'option_machinery': 'Machinery',
                'option_projects': 'Projects',
                'option_marble': 'Marble',
                'option_design': 'Design',
                'option_social': 'Social Media',
                'option_select_supervisor': 'Select Supervisor',
                // intro
                'decision_intro': 'We, Valencia Marble & Natural Stone Co., Human Resources Department, have decided the following: -',
                // telegram
                'telegram_title': 'ğŸ“‹ *New Administrative Order - Valencia Marble*',
                'telegram_order_info': 'ğŸ“… *Order Information:*',
                'telegram_employee_info': 'ğŸ‘¤ *Employee Information:*',
                'telegram_decision': 'ğŸ“œ *Decision Details:*',
                'telegram_footer': 'ğŸ›ï¸ *Valencia Marble & Natural Stone Trading Co.*\nğŸ“ HR Department\nğŸ”„ *This order was automatically generated by the electronic system*\nğŸ“Š *All rights reserved Â©',
                // notifications
                'notification_saved': 'âœ… Employee "{name}" added to list',
                'notification_reset': 'âœ… Serial number reset successfully',
                'notification_enter_name': 'âŒ Please enter employee name',
                'notification_enter_details': 'âŒ Please enter decision details',
                'notification_sending': 'ğŸ”„ Sending order to HR...',
                'notification_sent': 'âœ… Order for "{name}" sent to HR',
                'notification_failed': 'âŒ Failed to send order, please try again later',
                'notification_error': 'âŒ An error occurred during automatic sending',
                'notification_serial_saved': 'âœ… Serial number settings saved',
                'notification_backup_restored': 'âœ… Backup restored successfully',
                'notification_backup_failed': 'âŒ Failed to restore backup',
            }
        };

        let currentLang = 'ar'; // Ø§Ù„Ù„ØºØ© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©

        // Ø¯Ø§Ù„Ø© ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù„ØºØ©
        function toggleLanguage() {
            currentLang = currentLang === 'ar' ? 'en' : 'ar';
            document.body.setAttribute('lang', currentLang);
            document.documentElement.setAttribute('lang', currentLang);
            document.documentElement.dir = currentLang === 'ar' ? 'rtl' : 'ltr';
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†ØµÙˆØµ
            applyTranslations();
            
            // ØªØ­Ø¯ÙŠØ« Ø²Ø± Ø§Ù„Ù„ØºØ©
            document.getElementById('lang-btn-text').textContent = currentLang === 'ar' ? 'English' : 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©';
            
            // Ø­ÙØ¸ Ø§Ù„ØªÙØ¶ÙŠÙ„
            localStorage.setItem('valenciaLang', currentLang);
            
            // ØªØ­Ø¯ÙŠØ« Ù…Ù‚Ø¯Ù…Ø© Ø§Ù„Ù‚Ø±Ø§Ø±
            document.getElementById('decision-intro').textContent = translations[currentLang]['decision_intro'];
        }

        // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªÙŠ ØªØ­Ù…Ù„ data-i18n
        function applyTranslations() {
            // ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù†ØµÙˆØµ Ø§Ù„Ø«Ø§Ø¨ØªØ©
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[currentLang][key]) {
                    if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA' || el.tagName === 'SELECT') {
                        // Ù„Ø§ Ù†ØªØ±Ø¬Ù… Ø§Ù„Ù‚ÙŠÙ…Ø© Ù„Ù„Ù…Ø¯Ø®Ù„Ø§Øª
                    } else if (el.tagName === 'OPTION') {
                        // Ø³Ù†ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø¨Ø´ÙƒÙ„ Ù…Ù†ÙØµÙ„
                    } else {
                        el.innerHTML = translations[currentLang][key];
                    }
                }
            });
            
            // ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù€ placeholders
            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                if (translations[currentLang][key]) {
                    el.placeholder = translations[currentLang][key];
                }
            });
            
            // ØªØ±Ø¬Ù…Ø© Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù€ select
            document.querySelectorAll('[data-i18n-option]').forEach(el => {
                const key = el.getAttribute('data-i18n-option');
                if (translations[currentLang][key]) {
                    el.textContent = translations[currentLang][key];
                }
            });

            // ØªØ±Ø¬Ù…Ø© Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù†Ø¸Ø§Ù… Ø¯Ø§Ø®Ù„ Ø§Ù„Ù€ H2 (Ù…Ø¹ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø©)
            const sysTitle = document.getElementById('system-title');
            if (sysTitle) sysTitle.innerHTML = translations[currentLang]['system-title'];
            
            const subHeader = document.getElementById('company-subtitle-header');
            if (subHeader) subHeader.textContent = translations[currentLang]['company-subtitle-header'];
        }

        // =============================================
        // Ù…Ø¯ÙŠØ± Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ Ø§Ù„Ù…Ø­Ø³Ù†
        // =============================================

        class SerialNumberManager {
            constructor() {
                this.config = {
                    PREFIX: 'ORD',
                    DIGITS: 6,
                    RESET_MODE: 'NEVER',
                    SEPARATOR: '-',
                    INCLUDE_DATE: false,
                    DATE_FORMAT: 'YYYYMMDD'
                };

                this.counter = 1;
                this.lastUpdate = new Date();
                this.loadConfig();
                this.loadCounter();
                this.checkReset();
            }

            loadConfig() {
                const savedConfig = localStorage.getItem('valenciaSerialConfig');
                if (savedConfig) {
                    try {
                        this.config = { ...this.config, ...JSON.parse(savedConfig) };
                    } catch (e) {
                        console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ:', e);
                    }
                }
            }

            saveConfig() {
                localStorage.setItem('valenciaSerialConfig', JSON.stringify(this.config));
            }

            loadCounter() {
                const counterData = localStorage.getItem('valenciaOrderCounterData');

                if (counterData) {
                    try {
                        const data = JSON.parse(counterData);
                        this.counter = data.counter || 1;
                        this.lastUpdate = data.lastUpdate ? new Date(data.lastUpdate) : new Date();
                        this.backupCounter(data);
                    } catch (e) {
                        console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø¯Ø§Ø¯:', e);
                        this.resetToDefault();
                    }
                } else {
                    const oldCounter = localStorage.getItem('valenciaOrderCounter');
                    if (oldCounter) {
                        this.counter = parseInt(oldCounter) || 1;
                    }
                    this.resetToDefault();
                }
            }

            saveCounter() {
                const data = {
                    counter: this.counter,
                    lastUpdate: new Date().toISOString(),
                    prefix: this.config.PREFIX,
                    digits: this.config.DIGITS
                };

                localStorage.setItem('valenciaOrderCounterData', JSON.stringify(data));
                localStorage.setItem('valenciaOrderCounter', this.counter);
            }

            backupCounter(data) {
                const backups = JSON.parse(localStorage.getItem('valenciaCounterBackups') || '[]');
                if (backups.length >= 10) {
                    backups.shift();
                }
                backups.push({
                    ...data,
                    backupDate: new Date().toISOString()
                });
                localStorage.setItem('valenciaCounterBackups', JSON.stringify(backups));
            }

            resetToDefault() {
                this.counter = 1;
                this.lastUpdate = new Date();
                this.saveCounter();
            }

            checkReset() {
                const now = new Date();

                switch (this.config.RESET_MODE) {
                    case 'DAILY':
                        if (this.lastUpdate.getDate() !== now.getDate() ||
                            this.lastUpdate.getMonth() !== now.getMonth() ||
                            this.lastUpdate.getFullYear() !== now.getFullYear()) {
                            this.resetCounter(1);
                        }
                        break;
                    case 'MONTHLY':
                        if (this.lastUpdate.getMonth() !== now.getMonth() ||
                            this.lastUpdate.getFullYear() !== now.getFullYear()) {
                            this.resetCounter(1);
                        }
                        break;
                    case 'YEARLY':
                        if (this.lastUpdate.getFullYear() !== now.getFullYear()) {
                            this.resetCounter(1);
                        }
                        break;
                    default: break;
                }
            }

            generate() {
                this.checkReset();
                let serialNumber = this.config.PREFIX + this.config.SEPARATOR;

                if (this.config.INCLUDE_DATE) {
                    serialNumber += this.getFormattedDate() + this.config.SEPARATOR;
                }

                serialNumber += this.counter.toString().padStart(this.config.DIGITS, '0');
                this.counter++;
                this.saveCounter();
                return serialNumber;
            }

            getCurrent() {
                let serialNumber = this.config.PREFIX + this.config.SEPARATOR;
                if (this.config.INCLUDE_DATE) {
                    serialNumber += this.getFormattedDate() + this.config.SEPARATOR;
                }
                serialNumber += this.counter.toString().padStart(this.config.DIGITS, '0');
                return serialNumber;
            }

            getFormattedDate() {
                const now = new Date();
                const year = now.getFullYear();
                const month = (now.getMonth() + 1).toString().padStart(2, '0');
                const day = now.getDate().toString().padStart(2, '0');
                switch (this.config.DATE_FORMAT) {
                    case 'DDMMYYYY': return day + month + year;
                    case 'MMDDYYYY': return month + day + year;
                    case 'YYMMDD': return year.toString().slice(-2) + month + day;
                    default: return year + month + day;
                }
            }

            resetCounter(newValue = 1) {
                this.counter = newValue;
                this.lastUpdate = new Date();
                this.saveCounter();
                return this.getCurrent();
            }

            setCounter(value) {
                if (value >= 1) {
                    this.counter = value;
                    this.saveCounter();
                    return true;
                }
                return false;
            }

            updateConfig(newConfig) {
                this.config = { ...this.config, ...newConfig };
                this.saveConfig();
                return this.getCurrent();
            }

            getStats() {
                return {
                    currentCounter: this.counter,
                    nextSerial: this.getCurrent(),
                    lastUpdate: this.lastUpdate,
                    config: this.config,
                    backupsCount: JSON.parse(localStorage.getItem('valenciaCounterBackups') || '[]').length
                };
            }

            restoreBackup(index) {
                const backups = JSON.parse(localStorage.getItem('valenciaCounterBackups') || '[]');
                if (backups[index]) {
                    this.counter = backups[index].counter;
                    this.lastUpdate = new Date(backups[index].lastUpdate);
                    this.saveCounter();
                    return true;
                }
                return false;
            }
        }

        // =============================================
        // Ø¥Ø¯Ø§Ø±Ø© Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù…Ø­Ø³Ù†Ø©
        // =============================================

        class EmployeeManager {
            constructor() {
                this.employees = this.getDefaultEmployees();
                this.currentIndex = -1;
                this.loadSavedEmployees();
                this.initEventListeners();
            }

            getDefaultEmployees() {
                return [
                    "Ø¨Ø±ÙŠÙ†Ø³ Ø§Ù†ÙˆØ¨ÙŠÙ„",
                    "Ø³Ù‡ÙŠÙ„ Ø®Ø§Ù† ØµØ§Ø­Ø¨ Ø¹Ù„ÙŠ Ø®Ø§Ù†",
                    "Ø§ÙŠÙ…Ø§Ù†ÙˆÙŠÙ„ ÙŠØ¨ÙˆØ§Ù‡",
                    "Ù…Ø§ÙŠÙƒÙ„ Ø§Ù†ÙŠØ±ØªÙŠ Ø§ÙˆÙƒÙˆ",
                    "Ø¹Ø«Ù…Ø§Ù† ØµØ§Ù„Ø­ Ø¹Ø«Ù…Ø§Ù† Ø­Ø§Ù…Ø¯",
                    "Ø§Ø³Ù„Ø§Ù… Ù…Ø§Ù‡Ø± Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø§Ø²Ù‚ Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø§Ù„ØºÙ†Ø¯ÙˆØ±",
                    "ÙØ§Ø¯ÙŠ ÙŠÙˆØ³Ù Ø§Ù„Ø¹Ù„ÙˆÙ‡",
                    "Ù…Ø§Ù†ÙˆØ±ÙŠ Ø­Ù…Ø§Ù†Ù‰",
                    "ÙØ±Ø§Ù†Ø³ÙŠØ³ Ù†Ø§Ù†Ø§ Ø¨Ù„Ø§ÙŠ",
                    "Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø­Ù…Ù† Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ø­Ù…Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡"
                ];
            }

            loadSavedEmployees() {
                const savedEmployees = localStorage.getItem('valenciaEmployees');
                if (savedEmployees) {
                    try {
                        const parsed = JSON.parse(savedEmployees);
                        if (Array.isArray(parsed) && parsed.length > 0) {
                            const merged = [...new Set([...parsed, ...this.employees])];
                            this.employees = merged;
                        }
                    } catch (e) {
                        console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†:', e);
                    }
                }
            }

            saveEmployees() {
                localStorage.setItem('valenciaEmployees', JSON.stringify(this.employees));
            }

            addEmployee(name) {
                if (!name || !name.trim()) return false;
                const trimmedName = name.trim();
                if (!this.employees.includes(trimmedName)) {
                    this.employees.unshift(trimmedName);
                    this.saveEmployees();
                    return true;
                }
                return false;
            }

            searchEmployees(query) {
                if (!query || !query.trim()) {
                    return this.employees.slice(0, 10);
                }
                const lowerQuery = query.toLowerCase();
                return this.employees.filter(employee => 
                    employee.toLowerCase().includes(lowerQuery)
                ).slice(0, 10);
            }

            initEventListeners() {
                const input = document.getElementById('employee-input');
                const suggestions = document.getElementById('employee-suggestions');

                if (!input) return;

                input.addEventListener('input', (e) => {
                    const query = e.target.value;
                    this.showSuggestions(query);
                    saveData();
                });

                document.addEventListener('click', (e) => {
                    if (!input.contains(e.target) && !suggestions.contains(e.target)) {
                        suggestions.style.display = 'none';
                    }
                });

                input.addEventListener('focus', () => {
                    if (input.value.trim() === '') {
                        this.showSuggestions('');
                    }
                });

                input.addEventListener('keydown', (e) => {
                    const items = suggestions.querySelectorAll('.employee-suggestion-item');
                    
                    switch (e.key) {
                        case 'ArrowDown':
                            e.preventDefault();
                            this.navigateSuggestions(1);
                            break;
                        case 'ArrowUp':
                            e.preventDefault();
                            this.navigateSuggestions(-1);
                            break;
                        case 'Enter':
                            e.preventDefault();
                            this.selectCurrentSuggestion();
                            break;
                        case 'Escape':
                            suggestions.style.display = 'none';
                            break;
                        case 'Tab':
                            if (suggestions.style.display === 'block') {
                                this.selectCurrentSuggestion();
                            }
                            break;
                    }
                });

                input.addEventListener('blur', () => {
                    setTimeout(() => {
                        const value = input.value.trim();
                        if (value && !this.employees.includes(value)) {
                            this.addEmployee(value);
                            const msg = translations[currentLang]['notification_saved'].replace('{name}', value);
                            showAutoSendNotification(msg, 'success');
                        }
                    }, 200);
                });
            }

            showSuggestions(query) {
                const input = document.getElementById('employee-input');
                const suggestions = document.getElementById('employee-suggestions');
                
                if (!input || !suggestions) return;

                const results = this.searchEmployees(query);
                const exactMatch = results.find(emp => emp === query);
                const hasExactMatch = !!exactMatch;
                const inputValue = query.trim();

                let html = '';

                if (hasExactMatch) {
                    html += `<div class="employee-suggestion-item active" data-value="${exactMatch}">${exactMatch}</div>`;
                    this.currentIndex = 0;
                }

                results.forEach((employee, index) => {
                    if (employee !== exactMatch) {
                        const adjustedIndex = hasExactMatch ? index + 1 : index;
                        const isActive = adjustedIndex === this.currentIndex;
                        html += `<div class="employee-suggestion-item ${isActive ? 'active' : ''}" 
                                  data-value="${employee}">${employee}</div>`;
                    }
                });

                if (inputValue && !hasExactMatch && inputValue.length > 2) {
                    html += `<div class="employee-suggestion-item new-employee" 
                              data-value="${inputValue}">${currentLang === 'ar' ? 'Ø¥Ø¶Ø§ÙØ© "' + inputValue + '" ÙƒÙ…ÙˆØ¸Ù Ø¬Ø¯ÙŠØ¯' : 'Add "' + inputValue + '" as new employee'}</div>`;
                    
                    if (results.length === 0) {
                        this.currentIndex = 0;
                        suggestions.querySelector('.employee-suggestion-item')?.classList.add('active');
                    }
                }

                suggestions.innerHTML = html;
                suggestions.style.display = html ? 'block' : 'none';

                suggestions.querySelectorAll('.employee-suggestion-item').forEach((item, index) => {
                    item.addEventListener('click', () => {
                        const value = item.getAttribute('data-value');
                        
                        if (item.classList.contains('new-employee')) {
                            const newName = input.value.trim();
                            if (newName) {
                                this.addEmployee(newName);
                                const msg = translations[currentLang]['notification_saved'].replace('{name}', newName);
                                showAutoSendNotification(msg, 'success');
                            }
                        }
                        
                        input.value = value;
                        suggestions.style.display = 'none';
                        saveData();
                        input.focus();
                    });
                });
            }

            navigateSuggestions(direction) {
                const suggestions = document.getElementById('employee-suggestions');
                const items = suggestions.querySelectorAll('.employee-suggestion-item');
                
                if (items.length === 0) return;

                items.forEach(item => item.classList.remove('active'));

                this.currentIndex += direction;

                if (this.currentIndex < 0) this.currentIndex = items.length - 1;
                if (this.currentIndex >= items.length) this.currentIndex = 0;

                items[this.currentIndex].classList.add('active');
                items[this.currentIndex].scrollIntoView({ block: 'nearest', behavior: 'smooth' });
            }

            selectCurrentSuggestion() {
                const suggestions = document.getElementById('employee-suggestions');
                const items = suggestions.querySelectorAll('.employee-suggestion-item');
                const input = document.getElementById('employee-input');
                
                if (items.length === 0 || this.currentIndex < 0) return;

                const selectedItem = items[this.currentIndex];
                const value = selectedItem.getAttribute('data-value');
                
                if (selectedItem.classList.contains('new-employee')) {
                    const newName = input.value.trim();
                    if (newName) {
                        this.addEmployee(newName);
                        const msg = translations[currentLang]['notification_saved'].replace('{name}', newName);
                        showAutoSendNotification(msg, 'success');
                    }
                }
                
                input.value = value;
                suggestions.style.display = 'none';
                saveData();
            }

            getAllEmployees() {
                return [...this.employees];
            }

            loadCurrentEmployee() {
                const savedData = localStorage.getItem('valenciaOrderData');
                if (savedData) {
                    try {
                        const data = JSON.parse(savedData);
                        if (data.employeeName) {
                            document.getElementById('employee-input').value = data.employeeName;
                            
                            if (data.employeeName && !this.employees.includes(data.employeeName)) {
                                this.addEmployee(data.employeeName);
                            }
                        }
                    } catch (e) {
                        console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù:', e);
                    }
                }
            }
        }

        // =============================================
        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
        // =============================================

        let serialManager;
        let employeeManager;

        // =============================================
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø©
        // =============================================

        document.addEventListener('DOMContentLoaded', function() {
            // Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
            const savedLang = localStorage.getItem('valenciaLang');
            if (savedLang && (savedLang === 'ar' || savedLang === 'en')) {
                currentLang = savedLang;
            }
            document.body.setAttribute('lang', currentLang);
            document.documentElement.setAttribute('lang', currentLang);
            document.documentElement.dir = currentLang === 'ar' ? 'rtl' : 'ltr';
            document.getElementById('lang-btn-text').textContent = currentLang === 'ar' ? 'English' : 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©';

            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ø¯ÙŠØ±ÙŠÙ†
            serialManager = new SerialNumberManager();
            employeeManager = new EmployeeManager();

            // ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®
            setCurrentDate();
            setEffectiveDate();

            // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ
            updateSerialNumberDisplay();

            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
            loadSavedData();

            // ØªØ­Ù…ÙŠÙ„ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ø­Ø§Ù„ÙŠ
            employeeManager.loadCurrentEmployee();

            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª
            applyTranslations();
            document.getElementById('decision-intro').textContent = translations[currentLang]['decision_intro'];

            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
            document.querySelectorAll('.print-field').forEach(field => {
                if (field.id !== 'employee-input') {
                    field.addEventListener('input', saveData);
                    field.addEventListener('change', saveData);
                }
            });
        });

        function setCurrentDate() {
            const now = new Date();
            const day = now.getDate().toString().padStart(2, '0');
            const month = (now.getMonth() + 1).toString().padStart(2, '0');
            const year = now.getFullYear();
            const dateStr = `${day}-${month}-${year}`;
            document.getElementById('current-date').textContent = dateStr;
        }

        function setEffectiveDate() {
            const now = new Date();
            const day = now.getDate().toString().padStart(2, '0');
            const month = (now.getMonth() + 1).toString().padStart(2, '0');
            const year = now.getFullYear();
            const dateStr = `${day}/${month}/${year}`;
            document.getElementById('effective-date').value = dateStr;
        }

        function updateSerialNumberDisplay() {
            if (!serialManager) return;
            const serialNum = serialManager.getCurrent();
            document.getElementById('serial-number').textContent = serialNum;
            document.getElementById('current-serial-display').textContent = serialNum;
        }

        function generateNewSerialNumber() {
            if (!serialManager) return;
            const newSerial = serialManager.generate();
            updateSerialNumberDisplay();
            return newSerial;
        }

        function saveData() {
            const data = {
                orderType: document.getElementById('order-type').value,
                employeeName: document.getElementById('employee-input').value,
                employeeId: document.getElementById('employee-id').value,
                jobTitle: document.getElementById('job-title').value,
                departmentName: document.getElementById('department-name').value,
                supervisorName: document.getElementById('supervisor-name').value,
                decisionDetails: document.getElementById('decision-details').value,
                effectiveDate: document.getElementById('effective-date').value,
                issuerName: document.getElementById('issuer-name').value
            };
            localStorage.setItem('valenciaOrderData', JSON.stringify(data));
        }

        function loadSavedData() {
            const savedData = localStorage.getItem('valenciaOrderData');
            if (savedData) {
                try {
                    const data = JSON.parse(savedData);
                    document.getElementById('order-type').value = data.orderType || '';
                    document.getElementById('employee-id').value = data.employeeId || '';
                    document.getElementById('job-title').value = data.jobTitle || '';
                    document.getElementById('department-name').value = data.departmentName || '';
                    document.getElementById('supervisor-name').value = data.supervisorName || '';
                    document.getElementById('decision-details').value = data.decisionDetails || '';
                    document.getElementById('effective-date').value = data.effectiveDate || '';
                    document.getElementById('issuer-name').value = data.issuerName || '';
                } catch (e) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©:', e);
                    localStorage.removeItem('valenciaOrderData');
                }
            }
        }

        function resetSerialNumber() {
            if (!serialManager) return;
            serialManager.resetCounter(1);
            updateSerialNumberDisplay();
            showAutoSendNotification(translations[currentLang]['notification_reset'], 'success');
            closeResetConfirmation();
        }

        function showResetConfirmation() {
            if (!serialManager) return;

            const currentSerial = serialManager.getCurrent();
            const nextSerial = serialManager.config.PREFIX + '-000001';

            const modal = document.getElementById('resetConfirmationModal');
            modal.innerHTML = `
                <div class="confirmation-content">
                    <h3><i class="fas fa-exclamation-triangle"></i> ${currentLang === 'ar' ? 'ØªØ£ÙƒÙŠØ¯ ØªØµÙÙŠØ± Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ' : 'Confirm Reset Serial Number'}</h3>

                    <div style="text-align: ${currentLang === 'ar' ? 'right' : 'left'}; margin: 10px 0; padding: 8px; background: #f8f9fa; border-radius: 3px;">
                        <div style="margin-bottom: 5px;">
                            <strong>${currentLang === 'ar' ? 'Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ:' : 'Current Serial:'}</strong>
                            <span style="color: #c53030; font-weight: bold; margin-${currentLang === 'ar' ? 'right' : 'left'}: 10px;">${currentSerial}</span>
                        </div>
                        <div>
                            <strong>${currentLang === 'ar' ? 'Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯:' : 'New Serial:'}</strong>
                            <span style="color: #38a169; font-weight: bold; margin-${currentLang === 'ar' ? 'right' : 'left'}: 10px;">${nextSerial}</span>
                        </div>
                    </div>

                    <p>${currentLang === 'ar' ? 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ ØªØµÙÙŠØ± Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠØŸ' : 'Are you sure you want to reset the serial number?'}</p>
                    <p style="font-size: 9pt; color: #718096;">
                        <i class="fas fa-info-circle"></i>
                        ${currentLang === 'ar' ? 'Ø³ÙŠØªÙ… ÙÙ‚Ø¯Ø§Ù† ØªØ³Ù„Ø³Ù„ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡' : 'The current number sequence will be lost and this action cannot be undone.'}
                    </p>

                    <div class="confirmation-buttons">
                        <button class="btn-confirm" onclick="confirmResetSerial()">
                            <i class="fas fa-check"></i> ${currentLang === 'ar' ? 'Ù†Ø¹Ù…ØŒ ØªØµÙÙŠØ±' : 'Yes, Reset'}
                        </button>
                        <button class="btn-cancel" onclick="closeResetConfirmation()">
                            <i class="fas fa-times"></i> ${currentLang === 'ar' ? 'Ø¥Ù„ØºØ§Ø¡' : 'Cancel'}
                        </button>
                    </div>
                </div>
            `;

            modal.style.display = 'flex';
        }

        function closeResetConfirmation() {
            const modal = document.getElementById('resetConfirmationModal');
            if (modal) {
                modal.style.display = 'none';
            }
        }

        function confirmResetSerial() {
            resetSerialNumber();
        }

        function openSerialManager() {
            if (!serialManager) return;

            const stats = serialManager.getStats();
            const backups = JSON.parse(localStorage.getItem('valenciaCounterBackups') || '[]');

            const modal = document.createElement('div');
            modal.className = 'confirmation-modal';
            modal.id = 'serialManagerModal';
            modal.style.display = 'flex';

            modal.innerHTML = `
                <div class="confirmation-content" style="max-width: 500px;">
                    <h3><i class="fas fa-cog"></i> ${currentLang === 'ar' ? 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ' : 'Manage Serial Number'}</h3>

                    <div style="margin: 15px 0; padding: 10px; background: #f8f9fa; border-radius: 4px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <div style="font-weight: bold;">${currentLang === 'ar' ? 'Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ:' : 'Current Number:'}</div>
                            <div style="color: #1a365d; font-weight: bold; font-size: 14pt;">${stats.nextSerial}</div>
                        </div>

                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <div>${currentLang === 'ar' ? 'Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ø¯Ø¯ÙŠØ©:' : 'Counter Value:'}</div>
                            <div>${stats.currentCounter}</div>
                        </div>

                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <div>${currentLang === 'ar' ? 'Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«:' : 'Last Update:'}</div>
                            <div>${new Date(stats.lastUpdate).toLocaleString(currentLang === 'ar' ? 'ar-EG' : 'en-US')}</div>
                        </div>

                        <div style="display: flex; justify-content: space-between;">
                            <div>${currentLang === 'ar' ? 'Ø¹Ø¯Ø¯ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©:' : 'Backups count:'}</div>
                            <div>${stats.backupsCount}</div>
                        </div>
                    </div>

                    <div style="margin: 15px 0;">
                        <h4 style="margin-bottom: 10px; color: #2c5282; font-size: 10.5pt;">
                            <i class="fas fa-sliders-h"></i> ${currentLang === 'ar' ? 'Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª' : 'Settings'}
                        </h4>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 10px;">
                            <div>
                                <label style="display: block; margin-bottom: 3px; font-size: 9pt;">${currentLang === 'ar' ? 'Ø§Ù„Ø¨Ø§Ø¯Ø¦Ø©:' : 'Prefix:'}</label>
                                <input type="text" id="serial-prefix" value="${stats.config.PREFIX}"
                                       style="width: 100%; padding: 4px;">
                            </div>

                            <div>
                                <label style="display: block; margin-bottom: 3px; font-size: 9pt;">${currentLang === 'ar' ? 'Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…:' : 'Digits:'}</label>
                                <input type="number" id="serial-digits" value="${stats.config.DIGITS}" min="3" max="10"
                                       style="width: 100%; padding: 4px;">
                            </div>
                        </div>

                        <div style="margin-bottom: 10px;">
                            <label style="display: block; margin-bottom: 3px; font-size: 9pt;">${currentLang === 'ar' ? 'Ù†Ù…Ø· Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†:' : 'Reset Mode:'}</label>
                            <select id="serial-reset-mode" style="width: 100%; padding: 4px;">
                                <option value="NEVER" ${stats.config.RESET_MODE === 'NEVER' ? 'selected' : ''}>${currentLang === 'ar' ? 'Ù„Ø§ ØªØ¹ÙŠØ¯ Ø£Ø¨Ø¯Ø§Ù‹' : 'Never'}</option>
                                <option value="DAILY" ${stats.config.RESET_MODE === 'DAILY' ? 'selected' : ''}>${currentLang === 'ar' ? 'ÙŠÙˆÙ…ÙŠØ§Ù‹' : 'Daily'}</option>
                                <option value="MONTHLY" ${stats.config.RESET_MODE === 'MONTHLY' ? 'selected' : ''}>${currentLang === 'ar' ? 'Ø´Ù‡Ø±ÙŠØ§Ù‹' : 'Monthly'}</option>
                                <option value="YEARLY" ${stats.config.RESET_MODE === 'YEARLY' ? 'selected' : ''}>${currentLang === 'ar' ? 'Ø³Ù†ÙˆÙŠØ§Ù‹' : 'Yearly'}</option>
                            </select>
                        </div>

                        <div style="display: flex; align-items: center; margin-bottom: 10px;">
                            <input type="checkbox" id="serial-include-date" ${stats.config.INCLUDE_DATE ? 'checked' : ''}
                                   style="margin-left: 8px;">
                            <label for="serial-include-date" style="font-size: 9pt;">${currentLang === 'ar' ? 'ØªØ¶Ù…ÙŠÙ† Ø§Ù„ØªØ§Ø±ÙŠØ® ÙÙŠ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ' : 'Include date in serial number'}</label>
                        </div>
                    </div>

                    ${backups.length > 0 ? `
                    <div style="margin: 15px 0;">
                        <h4 style="margin-bottom: 10px; color: #2c5282; font-size: 10.5pt;">
                            <i class="fas fa-history"></i> ${currentLang === 'ar' ? 'Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©' : 'Backups'}
                        </h4>
                        <div style="max-height: 150px; overflow-y: auto; font-size: 8.5pt;">
                            ${backups.map((backup, index) => `
                                <div style="padding: 5px; border-bottom: 1px solid #e2e8f0; display: flex; justify-content: space-between;">
                                    <div>
                                        ${backup.prefix}-${backup.counter.toString().padStart(backup.digits || 6, '0')}
                                        <br><small>${new Date(backup.backupDate).toLocaleString(currentLang === 'ar' ? 'ar-EG' : 'en-US')}</small>
                                    </div>
                                    <button onclick="restoreBackup(${index})" style="padding: 2px 6px; font-size: 8pt; background: #4a5568; color: white; border: none; border-radius: 2px; cursor: pointer;">
                                        <i class="fas fa-undo"></i> ${currentLang === 'ar' ? 'Ø§Ø³ØªØ¹Ø§Ø¯Ø©' : 'Restore'}
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    ` : ''}

                    <div class="confirmation-buttons" style="justify-content: space-between; margin-top: 15px;">
                        <div>
                            <button class="btn-confirm" onclick="saveSerialSettings()" style="padding: 6px 12px;">
                                <i class="fas fa-save"></i> ${currentLang === 'ar' ? 'Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª' : 'Save Settings'}
                            </button>
                        </div>

                        <div>
                            <button class="btn-cancel" onclick="closeSerialManager()" style="padding: 6px 12px;">
                                <i class="fas fa-times"></i> ${currentLang === 'ar' ? 'Ø¥ØºÙ„Ø§Ù‚' : 'Close'}
                            </button>
                        </div>
                    </div>
                </div>
            `;

            document.body.appendChild(modal);
        }

        function closeSerialManager() {
            const modal = document.getElementById('serialManagerModal');
            if (modal) {
                modal.remove();
            }
        }

        function saveSerialSettings() {
            if (!serialManager) return;

            const newConfig = {
                PREFIX: document.getElementById('serial-prefix').value || 'ORD',
                DIGITS: parseInt(document.getElementById('serial-digits').value) || 6,
                RESET_MODE: document.getElementById('serial-reset-mode').value || 'NEVER',
                INCLUDE_DATE: document.getElementById('serial-include-date').checked
            };

            serialManager.updateConfig(newConfig);
            updateSerialNumberDisplay();

            showAutoSendNotification(translations[currentLang]['notification_serial_saved'], 'success');
            closeSerialManager();
        }

        function restoreBackup(index) {
            if (!serialManager) return;

            if (confirm(currentLang === 'ar' ? 'Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ù‡Ø°Ù‡ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©ØŸ' : 'Do you want to restore this backup?')) {
                const success = serialManager.restoreBackup(index);

                if (success) {
                    updateSerialNumberDisplay();
                    showAutoSendNotification(translations[currentLang]['notification_backup_restored'], 'success');
                    closeSerialManager();
                    setTimeout(openSerialManager, 500);
                } else {
                    showAutoSendNotification(translations[currentLang]['notification_backup_failed'], 'error');
                }
            }
        }

        async function sendToTelegramAuto() {
            const employeeName = document.getElementById('employee-input').value;

            if (!employeeName || !employeeName.trim()) {
                console.log('âš ï¸ Ù„Ù… ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø£Ù…Ø±: Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
                showAutoSendNotification(translations[currentLang]['notification_enter_name'], 'error');
                return false;
            }

            const decisionDetails = document.getElementById('decision-details').value;
            if (!decisionDetails || !decisionDetails.trim()) {
                showAutoSendNotification(translations[currentLang]['notification_enter_details'], 'error');
                return false;
            }

            if (employeeManager) {
                employeeManager.addEmployee(employeeName);
            }

            const chatId = TELEGRAM_CONFIG.CHANNELS.HR;
            const message = generateTelegramMessage();

            try {
                console.log('ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø£Ù…Ø± Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©...');
                showAutoSendNotification(translations[currentLang]['notification_sending'], 'sending');

                const success = await sendTelegramMessage(chatId, message);

                if (success) {
                    console.log(`âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø£Ù…Ø± "${employeeName}" ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©`);
                    const msg = translations[currentLang]['notification_sent'].replace('{name}', employeeName);
                    showAutoSendNotification(msg, 'success');
                    return true;
                } else {
                    console.log('âŒ ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©');
                    showAutoSendNotification(translations[currentLang]['notification_failed'], 'error');
                    return false;
                }
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ:', error);
                showAutoSendNotification(translations[currentLang]['notification_error'], 'error');
                return false;
            }
        }

        function showAutoSendNotification(message, type = 'success') {
            const existingNotification = document.getElementById('auto-send-notification');
            if (existingNotification) {
                existingNotification.remove();
            }

            const notification = document.createElement('div');
            notification.id = 'auto-send-notification';
            notification.className = type;

            let icon = '';
            if (type === 'success') icon = '<i class="fas fa-check-circle"></i>';
            else if (type === 'error') icon = '<i class="fas fa-exclamation-triangle"></i>';
            else if (type === 'info') icon = '<i class="fas fa-info-circle"></i>';
            else if (type === 'sending') icon = '<i class="fas fa-sync-alt fa-spin"></i>';

            notification.innerHTML = icon + message;

            document.body.appendChild(notification);

            setTimeout(() => {
                if (notification.parentNode) {
                    notification.style.animation = 'fadeOut 0.5s ease-out';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.remove();
                        }
                    }, 500);
                }
            }, 5000);
        }

        async function prepareAndPrint() {
            const employeeName = document.getElementById('employee-input').value;
            if (!employeeName || !employeeName.trim()) {
                showAutoSendNotification(translations[currentLang]['notification_enter_name'], 'error');
                return;
            }

            const decisionDetails = document.getElementById('decision-details').value;
            if (!decisionDetails || !decisionDetails.trim()) {
                showAutoSendNotification(translations[currentLang]['notification_enter_details'], 'error');
                return;
            }

            if (employeeManager) {
                employeeManager.addEmployee(employeeName);
            }

            generateNewSerialNumber();

            const sendResult = await sendToTelegramAuto();

            setTimeout(() => {
                saveData();
                window.print();
            }, sendResult ? 1000 : 500);
        }

        function generateTelegramMessage() {
            const orderType = document.getElementById('order-type').value || (currentLang === 'ar' ? 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' : 'Not specified');
            const employeeName = document.getElementById('employee-input').value || (currentLang === 'ar' ? 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ' : 'Unknown');
            const employeeId = document.getElementById('employee-id').value || (currentLang === 'ar' ? 'ØºÙŠØ± Ù…ØªÙˆÙØ±' : 'Not available');
            const jobTitle = document.getElementById('job-title').value || (currentLang === 'ar' ? 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' : 'Not specified');
            const departmentName = document.getElementById('department-name').value || (currentLang === 'ar' ? 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' : 'Not specified');
            const supervisorName = document.getElementById('supervisor-name').value || (currentLang === 'ar' ? 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' : 'Not specified');
            const decisionDetails = document.getElementById('decision-details').value || (currentLang === 'ar' ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙØ§ØµÙŠÙ„' : 'No details');
            const effectiveDate = document.getElementById('effective-date').value || (currentLang === 'ar' ? 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' : 'Not specified');
            const issuerName = document.getElementById('issuer-name').value || (currentLang === 'ar' ? 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' : 'Not specified');
            const serialNumber = document.getElementById('serial-number').textContent;
            const currentDate = document.getElementById('current-date').textContent;

            let message = translations[currentLang]['telegram_title'] + '\n';
            message += `â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n`;

            message += translations[currentLang]['telegram_order_info'] + '\n';
            message += `â€¢ ${currentLang === 'ar' ? 'Ø±Ù‚Ù… Ø§Ù„Ø£Ù…Ø±' : 'Order No.'}: ${serialNumber}\n`;
            message += `â€¢ ${currentLang === 'ar' ? 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø±' : 'Issue Date'}: ${currentDate}\n`;
            message += `â€¢ ${currentLang === 'ar' ? 'ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ†ÙÙŠØ°' : 'Effective Date'}: ${effectiveDate}\n`;
            message += `â€¢ ${currentLang === 'ar' ? 'Ù†ÙˆØ¹ Ø§Ù„Ø£Ù…Ø±' : 'Order Type'}: ${orderType}\n`;
            message += `â€¢ ${currentLang === 'ar' ? 'Ù…ÙØµÙ’Ø¯ÙØ± Ø§Ù„Ø£Ù…Ø±' : 'Issuer'}: ${issuerName}\n\n`;

            message += translations[currentLang]['telegram_employee_info'] + '\n';
            message += `â€¢ ${currentLang === 'ar' ? 'Ø§Ù„Ø§Ø³Ù…' : 'Name'}: ${employeeName}\n`;
            message += `â€¢ ${currentLang === 'ar' ? 'Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©' : 'ID No.'}: ${employeeId}\n`;
            message += `â€¢ ${currentLang === 'ar' ? 'Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ' : 'Job Title'}: ${jobTitle}\n`;
            message += `â€¢ ${currentLang === 'ar' ? 'Ø§Ù„Ù‚Ø³Ù…' : 'Department'}: ${departmentName}\n`;
            message += `â€¢ ${currentLang === 'ar' ? 'Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ù…Ø¨Ø§Ø´Ø±' : 'Supervisor'}: ${supervisorName}\n\n`;

            message += translations[currentLang]['telegram_decision'] + '\n';
            message += `â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n`;
            message += `${decisionDetails}\n\n`;

            message += `â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n`;
            message += translations[currentLang]['telegram_footer'] + ` ${new Date().getFullYear()}*\n`;

            return message;
        }

        async function sendTelegramMessage(chatId, message) {
            try {
                const url = `https://api.telegram.org/bot${TELEGRAM_CONFIG.BOT_TOKEN}/sendMessage`;

                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        chat_id: chatId,
                        text: message,
                        parse_mode: 'Markdown',
                        disable_web_page_preview: true
                    })
                });

                const result = await response.json();

                if (response.ok && result.ok) {
                    console.log('âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­:', result);
                    return true;
                } else {
                    console.error('âŒ ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©:', result);
                    showAutoSendNotification(translations[currentLang]['notification_failed'], 'error');
                    return false;
                }

            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„:', error);
                showAutoSendNotification(translations[currentLang]['notification_error'], 'error');
                return false;
            }
        }
    </script>
</body>
</html>
